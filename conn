import pandas as pd
import os

# Path to the folder containing Excel files
folder_path = 'path_to_your_folder'
output_file = 'combined_cleaned_output.xlsx'

# List all Excel files in the folder
file_list = [f for f in os.listdir(folder_path) if f.endswith('.xlsx') or f.endswith('.xls')]

# Initialize a flag to track the first file
first_file = True
combined_df = pd.DataFrame()

for file in file_list:
    file_path = os.path.join(folder_path, file)

    # Read Excel skipping the first 6 rows
    df = pd.read_excel(file_path, skiprows=6)

    # For first file, keep the columns
    if first_file:
        combined_df = df
        first_file = False
    else:
        # For others, just append assuming same column structure
        combined_df = pd.concat([combined_df, df], ignore_index=True)

# Save to a new Excel file
combined_df.to_excel(output_file, index=False)

print(f"Combined file saved as: {output_file}")

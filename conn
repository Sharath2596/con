import pandas as pd
import os

# Folder containing the CSV files
folder_path = 'path_to_your_folder'
output_file = 'combined_cleaned_output.csv'

# List all CSV files in the folder
file_list = [f for f in os.listdir(folder_path) if f.endswith('.csv')]

# Track if we're writing the first file (to include header)
first_file = True

for file in file_list:
    file_path = os.path.join(folder_path, file)

    # Use chunking for memory efficiency
    chunk_iter = pd.read_csv(file_path, skiprows=6, chunksize=10000)

    for chunk in chunk_iter:
        chunk.to_csv(output_file, mode='a', index=False, header=first_file)
        first_file = False  # Only include header once
